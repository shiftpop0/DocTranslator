import{r as A,_ as N}from"./index-m2bO0gKZ.js";import{p as $,E as T,s as ne,r as re,q as ue,t as de,v as ie}from"./element-BadtrIEY.js";import{u as ce}from"./usePagination-BinwZcSU.js";import{f as G,r as g,Q as K,h as f,E as h,G as l,M as e,K as s,a8 as a,w as pe,i as me,H as _e,ae as fe,u as p,j as x,L as E,ar as ge,as as ve}from"./vue-CUr9ttjf.js";import"./vxe-Ca06C60r.js";function we(r,m){return A({url:`customer/status/${r}`,method:"post",data:{status:m}})}function be(r){return A({url:`customer/${r.id}`,method:"post",data:r})}function he(r){return A({url:"customers",method:"get",params:r})}function ye(r){return A({url:"customer",method:"PUT",data:r})}function Ce(r){return A({url:`customer/${r}`,method:"delete"})}const Ve=G({__name:"register",emits:["success"],setup(r,{emit:m}){const d=m,F={email:"",password:"",level:"common"},c=g($(F)),D=g(null),v=K({email:[{required:!0,message:"请填写邮箱地址",trigger:"blur"}],level:[{required:!0,message:"请填写用户等级"}],password:[{required:!0,message:"请填写密码",trigger:"blur"}]}),S=()=>{var n;(n=D.value)==null||n.validate((i,C)=>{if(!i)return console.error("表单校验不通过",C);ye(c.value).then(()=>{T.success("操作成功"),d("success"),c.value=$(F)}).finally(()=>{})})};return(n,i)=>{const C=a("el-input"),V=a("el-form-item"),z=a("el-option"),q=a("el-select"),I=a("el-button"),U=a("el-form");return f(),h(U,{model:c.value,ref_key:"userform",ref:D,"label-width":"auto",rules:v},{default:l(()=>[e(V,{prop:"email",label:"邮箱"},{default:l(()=>[e(C,{modelValue:c.value.email,"onUpdate:modelValue":i[0]||(i[0]=w=>c.value.email=w),placeholder:"请输入邮箱",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),e(V,{prop:"level",label:"用户等级"},{default:l(()=>[e(q,{modelValue:c.value.level,"onUpdate:modelValue":i[1]||(i[1]=w=>c.value.level=w),placeholder:""},{default:l(()=>[e(z,{label:"会员用户",value:"vip"}),e(z,{label:"普通用户",value:"common"})]),_:1},8,["modelValue"])]),_:1}),e(V,{prop:"password",label:"密码"},{default:l(()=>[e(C,{type:"password",modelValue:c.value.password,"onUpdate:modelValue":i[2]||(i[2]=w=>c.value.password=w),placeholder:"请输入",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),e(V,{label:"",class:"center"},{default:l(()=>[e(I,{type:"primary",size:"large",color:"#055CF9",onClick:i[3]||(i[3]=w=>S()),style:{width:"100%"}},{default:l(()=>[s("提交")]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),ke=N(Ve,[["__scopeId","data-v-e1b2fb46"]]),xe=r=>(ge("data-v-01d32c5c"),r=r(),ve(),r),De={class:"app-container"},Se={class:"table-wrapper"},ze={class:"pager-wrapper"},Ue={class:"dialog_head"},Be={class:"title"},Me=xe(()=>x("span",{class:"ml-2"},"MB",-1)),$e={class:"btn_box"},Ae=G({name:"ElementPlus",__name:"index",setup(r){const m=g(!1),{paginationData:d,handleCurrentChange:F,handleSizeChange:c}=ce(),D={id:void 0,email:"",password:"",level:"common",add_storage:0},v=g(!1),S=g(null),n=g($(D)),i={email:[{required:!0,trigger:"blur",message:"请输入注册邮箱"}],password:[{min:2,max:16,message:"长度在 2 到 16 个字符",trigger:"blur"}],level:[{required:!0,trigger:"blur",message:"请选择用户等级"}]},C=()=>{var u;(u=S.value)==null||u.validate((o,M)=>{if(!o)return console.error("表单校验不通过",M);m.value=!0,be(n.value).then(()=>{T.success("操作成功"),v.value=!1,k()}).finally(()=>{m.value=!1})})},V=()=>{var u;(u=S.value)==null||u.clearValidate(),n.value=$(D),v.value=!1},z=(u,o)=>{we(u,o).then(()=>{T.success("更改状态成功"),k()})},q=u=>{ie.confirm(`正在删除用户：${u.email}，确认删除？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ce(u.id).then(()=>{T.success("删除成功"),k()})})},I=u=>{v.value=!0,n.value=Object.assign($(u),{password:""})},U=g([]),w=g(null),B=K({keyword:""}),k=()=>{m.value=!0,he({page:d.currentPage,limit:d.pageSize,keyword:B.keyword||void 0}).then(({data:u})=>{d.total=u.total,U.value=u.data}).catch(()=>{U.value=[]}).finally(()=>{m.value=!1})},Y=()=>{d.currentPage===1?k():d.currentPage=1},Q=()=>{B.keyword="",Y()},P=g(!1),J=()=>{P.value=!0},W=()=>{P.value=!1,k()};return pe([()=>d.currentPage,()=>d.pageSize],k,{immediate:!0}),(u,o)=>{const M=a("el-input"),y=a("el-form-item"),_=a("el-button"),j=a("el-form"),b=a("el-table-column"),R=a("el-tag"),X=a("el-table"),Z=a("el-pagination"),ee=a("el-card"),le=a("Close"),te=a("el-icon"),H=a("el-option"),ae=a("el-select"),oe=a("el-input-number"),L=a("el-dialog"),se=fe("loading");return f(),me("div",De,[_e((f(),h(ee,{shadow:"never"},{default:l(()=>[e(j,{ref_key:"searchFormRef",ref:w,inline:!0,model:B},{default:l(()=>[e(y,{prop:"username",label:"",style:{width:"320px","max-width":"100%"}},{default:l(()=>[e(M,{modelValue:B.keyword,"onUpdate:modelValue":o[0]||(o[0]=t=>B.keyword=t),placeholder:"输入查询"},null,8,["modelValue"])]),_:1}),e(y,null,{default:l(()=>[e(_,{type:"primary",icon:p(ne),onClick:Y},{default:l(()=>[s("查询")]),_:1},8,["icon"]),e(_,{icon:p(re),onClick:Q},{default:l(()=>[s("重置")]),_:1},8,["icon"])]),_:1}),e(y,null,{default:l(()=>[e(_,{type:"primary",icon:p(ue),onClick:J},{default:l(()=>[s("新增用户")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),x("div",Se,[e(X,{data:U.value},{default:l(()=>[e(b,{prop:"id",label:"用户编号",align:"left",width:"100"}),e(b,{prop:"email",label:"注册邮箱",align:"left"}),e(b,{prop:"level",label:"用户等级",align:"left",width:"100"},{default:l(t=>[t.row.level=="vip"?(f(),h(R,{key:0,type:"primary",effect:"plain"},{default:l(()=>[s("会员用户")]),_:1})):(f(),h(R,{key:1,type:"warning",effect:"plain"},{default:l(()=>[s("普通用户")]),_:1}))]),_:1}),e(b,{prop:"storage",label:"已用存储空间",align:"left",width:"120"},{default:l(({row:t})=>[s(E((t.storage/(1024*1024)).toFixed(2))+" MB ",1)]),_:1}),e(b,{prop:"storage",label:"总存储空间",align:"left",width:"120"},{default:l(({row:t})=>[s(E((t.total_storage/(1024*1024)).toFixed(2))+" MB ",1)]),_:1}),e(b,{prop:"status",label:"账户状态",align:"left",width:"80"},{default:l(t=>[t.row.status=="enabled"?(f(),h(R,{key:0,type:"success",effect:"plain"},{default:l(()=>[s("启用")]),_:1})):(f(),h(R,{key:1,type:"danger",effect:"plain"},{default:l(()=>[s("禁用")]),_:1}))]),_:1}),e(b,{prop:"created_at",label:"注册时间",align:"left"},{default:l(({row:t})=>[s(E(p(de)(t.created_at).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(b,{fixed:"right",label:"操作",width:"260",align:"left"},{default:l(t=>[e(_,{type:"primary",text:"",size:"small",onClick:O=>I(t.row)},{default:l(()=>[s("编辑")]),_:2},1032,["onClick"]),t.row.status=="enabled"?(f(),h(_,{key:0,type:"danger",text:"",size:"small",onClick:O=>z(t.row.id,"disabled")},{default:l(()=>[s("禁用")]),_:2},1032,["onClick"])):(f(),h(_,{key:1,type:"success",text:"",size:"small",onClick:O=>z(t.row.id,"enabled")},{default:l(()=>[s("启用")]),_:2},1032,["onClick"])),e(_,{type:"danger",text:"",size:"small",onClick:O=>q(t.row)},{default:l(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),x("div",ze,[e(Z,{background:"",layout:p(d).layout,"page-sizes":p(d).pageSizes,total:p(d).total,"page-size":p(d).pageSize,currentPage:p(d).currentPage,onSizeChange:p(c),onCurrentChange:p(F)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[se,m.value]]),e(L,{"modal-class":"custom_dialog",modelValue:v.value,"onUpdate:modelValue":o[6]||(o[6]=t=>v.value=t),"show-close":!1},{header:l(()=>[x("div",Ue,[x("div",Be,E(n.value.id===void 0?"新增用户":"编辑用户信息"),1),e(te,{onClick:V},{default:l(()=>[e(le)]),_:1})])]),default:l(()=>[e(j,{ref_key:"formRef",ref:S,model:n.value,rules:i,"label-width":"150px","label-position":"left"},{default:l(()=>[e(y,{prop:"email",label:"注册邮箱"},{default:l(()=>[e(M,{modelValue:n.value.email,"onUpdate:modelValue":o[1]||(o[1]=t=>n.value.email=t),placeholder:"请输入注册邮箱"},null,8,["modelValue"])]),_:1}),e(y,{prop:"level",label:"用户等级"},{default:l(()=>[e(ae,{modelValue:n.value.level,"onUpdate:modelValue":o[2]||(o[2]=t=>n.value.level=t),placeholder:""},{default:l(()=>[e(H,{label:"会员用户",value:"vip"}),e(H,{label:"普通用户",value:"common"})]),_:1},8,["modelValue"])]),_:1}),e(y,{prop:"storage",label:"新增存储空间(MB)"},{default:l(()=>[e(oe,{style:{width:"80%"},precision:0,modelValue:n.value.add_storage,"onUpdate:modelValue":o[3]||(o[3]=t=>n.value.add_storage=t),step:5,placeholder:"请输入需要添加的存储空间(MB)"},null,8,["modelValue"]),Me]),_:1}),e(y,{prop:"password",label:"密码"},{default:l(()=>[e(M,{type:"password",modelValue:n.value.password,"onUpdate:modelValue":o[4]||(o[4]=t=>n.value.password=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),x("div",$e,[e(_,{onClick:o[5]||(o[5]=t=>v.value=!1)},{default:l(()=>[s("取消")]),_:1}),e(_,{type:"primary",onClick:C,loading:m.value},{default:l(()=>[s("确认")]),_:1},8,["loading"])])]),_:1},8,["modelValue"]),e(L,{modelValue:P.value,"onUpdate:modelValue":o[7]||(o[7]=t=>P.value=t),center:"",width:"90%","modal-class":"custom_dialog login_dialog","show-close":!1},{header:l(()=>[s(" 添加用户 ")]),default:l(()=>[e(ke,{onSuccess:W})]),_:1},8,["modelValue"])])}}}),qe=N(Ae,[["__scopeId","data-v-01d32c5c"]]);export{qe as default};
