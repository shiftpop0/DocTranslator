import{r as w,Q as k,h as E,i as q,M as e,G as a,u,K as g,a8 as i,ar as I,as as R,aq as S,j as f}from"./vue-CUr9ttjf.js";import{y as U,z as B,A as v,E as m}from"./element-BadtrIEY.js";import{_ as N,h as P}from"./index-D8_CIAd1.js";import"./vxe-Ca06C60r.js";const A=p=>(I("data-v-e4df9e91"),p=p(),R(),p),M={class:"security-settings"},j=A(()=>f("div",{class:"card-header"},[f("h2",{class:"title"},"账户安全设置"),f("p",{class:"subtitle"},"请谨慎修改您的账户信息")],-1)),z={__name:"index",setup(p){const c=w(),t=w(!1),x=S(),o=k({user:"",old_password:"",new_password:"",confirm_password:""}),V={old_password:[{required:!0,message:"请输入原密码",trigger:"blur"}],new_password:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:(d,s,r)=>{s.length<2?r(new Error("密码至少需要2位")):r()},trigger:"blur"}],confirm_password:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(d,s,r)=>{s!==o.new_password?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]},b=async()=>{try{await c.value.validate(),t.value=!0,(await P(o)).code===200?(t.value=!1,m.success("修改成功"),x.push("/login")):(t.value=!1,m.error("修改失败，请重试"))}catch(d){m.error(d.message||"修改失败"),t.value=!1}},h=()=>{c.value.resetFields()};return(d,s)=>{const r=i("el-input"),n=i("el-form-item"),_=i("el-button"),y=i("el-form"),C=i("el-card");return E(),q("div",M,[e(C,{class:"settings-card"},{default:a(()=>[j,e(y,{ref_key:"formRef",ref:c,model:o,rules:V,"label-position":"top",class:"settings-form"},{default:a(()=>[e(n,{label:"用户名",prop:"user"},{default:a(()=>[e(r,{modelValue:o.user,"onUpdate:modelValue":s[0]||(s[0]=l=>o.user=l),placeholder:"请输入新的用户名(邮箱)",clearable:"","prefix-icon":u(U)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"原密码",prop:"old_password"},{default:a(()=>[e(r,{modelValue:o.old_password,"onUpdate:modelValue":s[1]||(s[1]=l=>o.old_password=l),type:"password","show-password":"",placeholder:"请输入当前密码","prefix-icon":u(B)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"新密码",prop:"new_password"},{default:a(()=>[e(r,{modelValue:o.new_password,"onUpdate:modelValue":s[2]||(s[2]=l=>o.new_password=l),type:"password","show-password":"",placeholder:"2-16位长度","prefix-icon":u(v)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"确认新密码",prop:"confirm_password"},{default:a(()=>[e(r,{modelValue:o.confirm_password,"onUpdate:modelValue":s[3]||(s[3]=l=>o.confirm_password=l),type:"password","show-password":"",placeholder:"请再次输入新密码","prefix-icon":u(v)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{class:"form-actions"},{default:a(()=>[e(_,{type:"primary",loading:t.value,onClick:b},{default:a(()=>[g(" 保存修改 ")]),_:1},8,["loading"]),e(_,{onClick:h},{default:a(()=>[g("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},H=N(z,[["__scopeId","data-v-e4df9e91"]]);export{H as default};
