import{r as w,aD as E,Z as k,ah as p,m as S,p as U,U as e,O as r,u,S as g,aE as q,aF as I,q as f}from"./vue-DSQ7aDT9.js";import{x as R,y as B,z as v,E as m}from"./element-C0HbadzC.js";import{_ as N,h as P}from"./index-B9xB4neq.js";import"./vxe-D9jD_6gD.js";const D=i=>(q("data-v-2cf7ca4b"),i=i(),I(),i),F={class:"security-settings"},z=D(()=>f("div",{class:"card-header"},[f("h2",{class:"title"},"账户安全设置"),f("p",{class:"subtitle"},"请谨慎修改您的账户信息")],-1)),A={__name:"index",setup(i){const c=w(),t=w(!1),b=E(),o=k({user:"",old_password:"",new_password:"",confirm_password:""}),x={old_password:[{required:!0,message:"请输入原密码",trigger:"blur"}],new_password:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:(d,s,a)=>{s.length<6?a(new Error("密码至少需要6位")):a()},trigger:"blur"}],confirm_password:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(d,s,a)=>{s!==o.new_password?a(new Error("两次输入的密码不一致")):a()},trigger:"blur"}]},V=async()=>{try{await c.value.validate(),t.value=!0,(await P(o)).code===200?(t.value=!1,m.success("修改成功"),b.push("/login")):(t.value=!1,m.error("修改失败，请重试"))}catch(d){m.error(d.message||"修改失败"),t.value=!1}},h=()=>{c.value.resetFields()};return(d,s)=>{const a=p("el-input"),n=p("el-form-item"),_=p("el-button"),y=p("el-form"),C=p("el-card");return S(),U("div",F,[e(C,{class:"settings-card"},{default:r(()=>[z,e(y,{ref_key:"formRef",ref:c,model:o,rules:x,"label-position":"top",class:"settings-form"},{default:r(()=>[e(n,{label:"用户名",prop:"user"},{default:r(()=>[e(a,{modelValue:o.user,"onUpdate:modelValue":s[0]||(s[0]=l=>o.user=l),placeholder:"请输入新的用户名(邮箱)",clearable:"","prefix-icon":u(R)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"原密码",prop:"old_password"},{default:r(()=>[e(a,{modelValue:o.old_password,"onUpdate:modelValue":s[1]||(s[1]=l=>o.old_password=l),type:"password","show-password":"",placeholder:"请输入当前密码","prefix-icon":u(B)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"新密码",prop:"new_password"},{default:r(()=>[e(a,{modelValue:o.new_password,"onUpdate:modelValue":s[2]||(s[2]=l=>o.new_password=l),type:"password","show-password":"",placeholder:"6-16位长度","prefix-icon":u(v)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"确认新密码",prop:"confirm_password"},{default:r(()=>[e(a,{modelValue:o.confirm_password,"onUpdate:modelValue":s[3]||(s[3]=l=>o.confirm_password=l),type:"password","show-password":"",placeholder:"请再次输入新密码","prefix-icon":u(v)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{class:"form-actions"},{default:r(()=>[e(_,{type:"primary",loading:t.value,onClick:V},{default:r(()=>[g(" 保存修改 ")]),_:1},8,["loading"]),e(_,{onClick:h},{default:r(()=>[g("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},H=N(A,[["__scopeId","data-v-2cf7ca4b"]]);export{H as default};
