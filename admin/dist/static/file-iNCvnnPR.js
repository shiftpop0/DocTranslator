import{r as F,d as le,ah as m,ap as oe,m as c,p as v,q as a,U as e,O as t,u as p,S as _,P as ne,M as z,T as d,F as C,a7 as N,a2 as q,Q as G,aE as de,aF as ie}from"./vue-DSQ7aDT9.js";import{A as ce,r as _e,B as ue,t as w,C as Q,w as re,E as M,D as A,F as J,G as R,H as W,I as X}from"./element-C0HbadzC.js";import{r as Z,_ as fe}from"./index-B9xB4neq.js";import"./vxe-D9jD_6gD.js";function pe(){return Z({url:"system/storage",method:"get"})}function Y(x){return Z({url:"system/storage",method:"delete",data:x})}const H=x=>(de("data-v-dc331810"),x=x(),ie(),x),me={class:"file-manager"},he={class:"header"},ve={class:"tab-label"},ge=H(()=>a("span",null,"上传文档",-1)),be={class:"category-actions"},ye={class:"date-header"},ze={class:"date-text"},xe={class:"date-meta"},ke={class:"file-count"},Ce={class:"date-size"},we={class:"date-actions"},Be={class:"file-table-container"},Ve={class:"file-name-cell"},$e={class:"file-name"},Fe={class:"file-path"},Me={key:1,class:"empty-container"},De={class:"tab-label"},Ie=H(()=>a("span",null,"翻译文档",-1)),Se={class:"category-actions"},Ee={class:"date-header"},Le={class:"date-text"},Te={class:"date-meta"},Ue={class:"file-count"},Oe={class:"date-size"},je={class:"date-actions"},Ne={class:"file-table-container"},qe={class:"file-name-cell"},Ge={class:"file-name"},Ae={class:"file-path"},He={key:1,class:"empty-container"},Ke={class:"tab-label"},Pe=H(()=>a("span",null,"doc2x文档",-1)),Qe={class:"category-actions"},Je={class:"date-header"},Re={class:"date-text"},We={class:"date-meta"},Xe={class:"file-count"},Ye={class:"date-size"},Ze={class:"date-actions"},et={class:"file-table-container"},tt={class:"file-name-cell"},at={class:"file-name"},st={class:"file-path"},lt={key:1,class:"empty-container"},ot={__name:"file",setup(x){const V=F(!1),h=F({uploads:{size:0,dates:{}},translate:{size:0,dates:{}},doc2x_results:{size:0,dates:{}}}),K=F("uploads"),y=F({uploads:[],translate:[],doc2x_results:[]}),D=i=>{var s;return((s=h.value[i])==null?void 0:s.dates)&&Object.keys(h.value[i].dates).length>0};le(()=>{$()});const $=async()=>{try{V.value=!0;const i=await pe();if(i.code===200){h.value={uploads:i.data.uploads||{size:0,dates:{}},translate:i.data.translate||{size:0,dates:{}},doc2x_results:i.data.doc2x_results||{size:0,dates:{}}};for(const s in h.value)Object.keys(h.value[s].dates).length>0&&(y.value[s]=[Object.keys(h.value[s].dates)[0]])}}finally{V.value=!1}},ee=()=>$(),g=i=>{if(i===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],u=Math.floor(Math.log(i)/Math.log(s));return parseFloat((i/Math.pow(s,u)).toFixed(2))+" "+n[u]},I=i=>{const s=i.split(".").pop().toLowerCase();return{pdf:J,doc:R,docx:R,xls:W,xlsx:W,ppt:X,pptx:X}[s]||J},S=async i=>{try{await Y({type:"file",target:i}),M.success("文件删除成功"),await $()}catch(s){M.error("删除失败: "+s.message)}},k=(i,s)=>{const n={file:`确定要删除文件 "${s.split("/").pop()}" 吗？`,date:`确定要删除日期 "${s.split("/")[1]}" 的所有文件吗？`,category:`确定要删除整个 "${s}" 分类吗？`};re.confirm(n[i],"警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",beforeClose:async(u,b,r)=>{if(u==="confirm"){b.confirmButtonLoading=!0;try{await Y({type:i,target:s}),M.success("删除成功"),await $(),r()}catch(B){M.error("删除失败: "+B.message)}finally{b.confirmButtonLoading=!1}}else r()}}).catch(()=>{})};return(i,s)=>{const n=m("el-icon"),u=m("el-button"),b=m("el-tag"),r=m("el-table-column"),B=m("el-tooltip"),E=m("el-popconfirm"),L=m("el-table"),T=m("el-collapse-item"),U=m("el-collapse"),O=m("el-empty"),j=m("el-tab-pane"),te=m("el-tabs"),ae=m("el-card"),se=oe("loading");return c(),v("div",me,[a("div",he,[a("h2",null,[e(n,{class:"header-icon"},{default:t(()=>[e(p(ce))]),_:1}),_(" 文件存储管理 ")]),e(u,{type:"primary",plain:"",onClick:ee,loading:V.value,class:"refresh-btn"},{default:t(()=>[e(n,null,{default:t(()=>[e(p(_e))]),_:1}),_("刷新 ")]),_:1},8,["loading"])]),ne((c(),z(ae,{class:"content-card","element-loading-text":"加载中..."},{default:t(()=>[e(te,{modelValue:K.value,"onUpdate:modelValue":s[6]||(s[6]=o=>K.value=o),class:"main-tabs"},{default:t(()=>[e(j,{name:"uploads"},{label:t(()=>[a("div",ve,[e(n,{class:"tab-icon uploads"},{default:t(()=>[e(p(ue))]),_:1}),ge,e(b,{size:"small",effect:"light",class:"size-tag"},{default:t(()=>{var o;return[_(d(g(((o=h.value.uploads)==null?void 0:o.size)||0)),1)]}),_:1})])]),default:t(()=>[D("uploads")?(c(),v(C,{key:0},[a("div",be,[e(u,{type:"danger",size:"medium",onClick:s[0]||(s[0]=o=>k("category","uploads")),class:"delete-category-btn"},{default:t(()=>[e(n,null,{default:t(()=>[e(p(w))]),_:1}),_("删除全部文件 ")]),_:1})]),e(U,{modelValue:y.value.uploads,"onUpdate:modelValue":s[1]||(s[1]=o=>y.value.uploads=o),accordion:"",class:"date-collapse"},{default:t(()=>[(c(!0),v(C,null,N(h.value.uploads.dates,(o,f)=>(c(),z(T,{key:f,name:f,class:"date-item"},{title:t(()=>[a("div",ye,[e(n,{size:"20",class:"date-icon"},{default:t(()=>[e(p(A))]),_:1}),a("span",ze,d(f),1),a("div",xe,[a("span",ke,d(o.files.length)+"个文件",1),a("span",Ce,"共"+d(g(o.size)),1)]),a("div",we,[e(u,{type:"danger",size:"small",plain:"",onClick:q(l=>k("date",`uploads/${f}`),["stop"]),class:"delete-date-btn"},{default:t(()=>[e(n,null,{default:t(()=>[e(p(w))]),_:1}),_("删除本日所有文件 ")]),_:2},1032,["onClick"])])])]),default:t(()=>[a("div",Be,[e(L,{data:o.files,border:"",stripe:"","empty-text":"该日期没有文件",class:"file-table"},{default:t(()=>[e(r,{label:"文件名",width:"220"},{default:t(({row:l})=>[a("div",Ve,[e(n,{class:"file-icon"},{default:t(()=>[(c(),z(G(I(l.name))))]),_:2},1024),a("span",$e,d(l.name),1)])]),_:1}),e(r,{label:"大小",width:"120"},{default:t(({row:l})=>[e(b,{size:"small",effect:"plain"},{default:t(()=>[_(d(g(l.size)),1)]),_:2},1024)]),_:1}),e(r,{label:"文件路径","min-width":"300"},{default:t(({row:l})=>[e(B,{content:l.path,placement:"top"},{default:t(()=>[a("span",Fe,d(l.path),1)]),_:2},1032,["content"])]),_:1}),e(r,{label:"操作",width:"120",align:"center"},{default:t(({row:l})=>[e(E,{title:"确定要删除此文件吗？",onConfirm:P=>S(l.path)},{reference:t(()=>[e(u,{type:"danger",size:"small",round:""},{default:t(()=>[_(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:2},1032,["data"])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])],64)):(c(),v("div",Me,[e(O,{description:"暂无上传文件"})]))]),_:1}),e(j,{name:"translate"},{label:t(()=>[a("div",De,[e(n,{class:"tab-icon translate"},{default:t(()=>[e(p(Q))]),_:1}),Ie,e(b,{size:"small",effect:"light",class:"size-tag"},{default:t(()=>{var o;return[_(d(g(((o=h.value.translate)==null?void 0:o.size)||0)),1)]}),_:1})])]),default:t(()=>[D("translate")?(c(),v(C,{key:0},[a("div",Se,[e(u,{type:"danger",size:"small",onClick:s[2]||(s[2]=o=>k("category","translate")),class:"delete-category-btn"},{default:t(()=>[e(n,null,{default:t(()=>[e(p(w))]),_:1}),_("删除全部文件 ")]),_:1})]),e(U,{modelValue:y.value.translate,"onUpdate:modelValue":s[3]||(s[3]=o=>y.value.translate=o),accordion:"",class:"date-collapse"},{default:t(()=>[(c(!0),v(C,null,N(h.value.translate.dates,(o,f)=>(c(),z(T,{key:f,name:f,class:"date-item"},{title:t(()=>[a("div",Ee,[e(n,{size:"20",class:"date-icon"},{default:t(()=>[e(p(A))]),_:1}),a("span",Le,d(f),1),a("div",Te,[a("span",Ue,d(o.files.length)+"个文件",1),a("span",Oe,"共"+d(g(o.size)),1)]),a("div",je,[e(u,{type:"danger",size:"small",onClick:q(l=>k("date",`translate/${f}`),["stop"]),class:"delete-date-btn"},{default:t(()=>[e(n,null,{default:t(()=>[e(p(w))]),_:1}),_("删除本日所有文件 ")]),_:2},1032,["onClick"])])])]),default:t(()=>[a("div",Ne,[e(L,{data:o.files,border:"",stripe:"","empty-text":"该日期没有文件",class:"file-table"},{default:t(()=>[e(r,{label:"文件名",width:"220"},{default:t(({row:l})=>[a("div",qe,[e(n,{class:"file-icon"},{default:t(()=>[(c(),z(G(I(l.name))))]),_:2},1024),a("span",Ge,d(l.name),1)])]),_:1}),e(r,{label:"大小",width:"120"},{default:t(({row:l})=>[e(b,{size:"small",effect:"plain"},{default:t(()=>[_(d(g(l.size)),1)]),_:2},1024)]),_:1}),e(r,{label:"文件路径","min-width":"300"},{default:t(({row:l})=>[e(B,{content:l.path,placement:"top"},{default:t(()=>[a("span",Ae,d(l.path),1)]),_:2},1032,["content"])]),_:1}),e(r,{label:"操作",width:"120",align:"center"},{default:t(({row:l})=>[e(E,{title:"确定要删除此文件吗？",onConfirm:P=>S(l.path)},{reference:t(()=>[e(u,{type:"danger",size:"small",round:""},{default:t(()=>[_(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:2},1032,["data"])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])],64)):(c(),v("div",He,[e(O,{description:"暂无翻译文件"})]))]),_:1}),e(j,{name:"doc2x_results"},{label:t(()=>[a("div",Ke,[e(n,{class:"tab-icon translate"},{default:t(()=>[e(p(Q))]),_:1}),Pe,e(b,{size:"small",effect:"light",class:"size-tag"},{default:t(()=>{var o;return[_(d(g(((o=h.value.doc2x_results)==null?void 0:o.size)||0)),1)]}),_:1})])]),default:t(()=>[D("doc2x_results")?(c(),v(C,{key:0},[a("div",Qe,[e(u,{type:"danger",size:"small",onClick:s[4]||(s[4]=o=>k("category","doc2x_results")),class:"delete-category-btn"},{default:t(()=>[e(n,null,{default:t(()=>[e(p(w))]),_:1}),_("删除全部文件 ")]),_:1})]),e(U,{modelValue:y.value.doc2x_results,"onUpdate:modelValue":s[5]||(s[5]=o=>y.value.doc2x_results=o),accordion:"",class:"date-collapse"},{default:t(()=>[(c(!0),v(C,null,N(h.value.doc2x_results.dates,(o,f)=>(c(),z(T,{key:f,name:f,class:"date-item"},{title:t(()=>[a("div",Je,[e(n,{size:"20",class:"date-icon"},{default:t(()=>[e(p(A))]),_:1}),a("span",Re,d(f),1),a("div",We,[a("span",Xe,d(o.files.length)+"个文件",1),a("span",Ye,"共"+d(g(o.size)),1)]),a("div",Ze,[e(u,{type:"danger",size:"small",onClick:q(l=>k("date",`doc2x_results/${f}`),["stop"]),class:"delete-date-btn"},{default:t(()=>[e(n,null,{default:t(()=>[e(p(w))]),_:1}),_("删除本日所有文件 ")]),_:2},1032,["onClick"])])])]),default:t(()=>[a("div",et,[e(L,{data:o.files,border:"",stripe:"","empty-text":"该日期没有文件",class:"file-table"},{default:t(()=>[e(r,{label:"文件名",width:"220"},{default:t(({row:l})=>[a("div",tt,[e(n,{class:"file-icon"},{default:t(()=>[(c(),z(G(I(l.name))))]),_:2},1024),a("span",at,d(l.name),1)])]),_:1}),e(r,{label:"大小",width:"120"},{default:t(({row:l})=>[e(b,{size:"small",effect:"plain"},{default:t(()=>[_(d(g(l.size)),1)]),_:2},1024)]),_:1}),e(r,{label:"文件路径","min-width":"300"},{default:t(({row:l})=>[e(B,{content:l.path,placement:"top"},{default:t(()=>[a("span",st,d(l.path),1)]),_:2},1032,["content"])]),_:1}),e(r,{label:"操作",width:"120",align:"center"},{default:t(({row:l})=>[e(E,{title:"确定要删除此文件吗？",onConfirm:P=>S(l.path)},{reference:t(()=>[e(u,{type:"danger",size:"small",round:""},{default:t(()=>[_(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:2},1032,["data"])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])],64)):(c(),v("div",lt,[e(O,{description:"暂无doc2x处理文件"})]))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["element-loading-text"])),[[se,V.value]])])}}},_t=fe(ot,[["__scopeId","data-v-dc331810"]]);export{_t as default};
